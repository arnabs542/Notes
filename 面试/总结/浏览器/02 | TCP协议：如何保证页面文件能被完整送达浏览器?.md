## TCP协议：如何保证页面文件能被完整送达浏览器？
![20200825095558](https://hzy-1301560453.cos.ap-shanghai.myqcloud.com/2020/pictures/20200825095558.png)

- **IP：把数据包送达目的主机**

计算机的地址就称为 IP 地址，访问任何网站实际上只是你的计算机向另外一台计算机请求信息。
主机A -> 主机B，在传输之前，数据包会附加上主机B的信息，数据包也会附加主机A的信息方便回溯。附加信息被装在IP头数据结构。
**IP 头**是 IP 数据包开头的信息，包含 IP 版本、源 IP 地址、目标 IP 地址、生存时间等信息。如果你要详细了解 IP 头信息：
![20200831081117](https://hzy-1301560453.cos.ap-shanghai.myqcloud.com/2020/pictures/20200831081117.png)

- **UDP：把数据包送达应用程序**
UDP绑定端口号。IP 通过 IP 地址信息把数据包发送给指定的电脑，而 UDP 通过端口号把数据包分发给正确的程序。和IP头一样，端口号呗装进UDP里面。**UDP 头**中除了目的端口，还有源端口号等信息。
![20200831081605](https://hzy-1301560453.cos.ap-shanghai.myqcloud.com/2020/pictures/20200831081605.png)
UDP 不能保证数据可靠性，但是传输速度却非常快。

- **TCP：把数据完整地送达应用程序**
TCP（Transmission Control Protocol，传输控制协议）是一种面向连接的、可靠的、基于字节流的传输层通信协议。
  - 对于数据包丢失的情况，TCP 提供重传机制；
  - TCP 引入了数据包排序机制，用来保证把乱序的数据包组合成一个完整的文件。
![20200831082104](https://hzy-1301560453.cos.ap-shanghai.myqcloud.com/2020/pictures/20200831082104.png)

![20200831082139](https://hzy-1301560453.cos.ap-shanghai.myqcloud.com/2020/pictures/20200831082139.png)
一个完整的 TCP 连接的生命周期包括了“建立连接”“传输数据”和“断开连接”三个阶段。
TCP 为了保证数据传输的可靠性，牺牲了数据包的传输速度，因为“三次握手”和“数据包校验机制”等把传输过程中的数据包的数量提高了一倍。

**总结**
- 互联网中的数据是通过数据包来传输的，数据包在传输过程中容易丢失或出错。
- IP 负责把数据包送达目的主机。
- UDP 负责把数据包送达具体应用。
- 而 TCP 保证了数据完整地传输，它的连接可分为三个阶段：建立连接、传输数据和断开连接。

**小问题：**
理解 HTTP 和 TCP 的关系？

- HTTP协议和TCP协议都是TCP/IP协议簇的子集。

- HTTP协议属于应用层，TCP协议属于传输层，HTTP协议位于TCP协议的上层。

- 请求方要发送的数据包，在应用层加上HTTP头以后会交给传输层的TCP协议处理，应答方接收到的数据包，在传输层拆掉TCP头以后交给应用层的HTTP协议处理。建立 TCP 连接后会顺序收发数据，请求方和应答方都必须依据 HTTP 规范构建和解析HTTP报文。